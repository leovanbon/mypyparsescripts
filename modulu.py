import math
from sympy import *
from Crypto.Util.number import long_to_bytes, bytes_to_long

# n = 23574677584619722940904557175146815570703405076128125147833571616704202841496478125812612581400865973773808001599312336023897367065914618939864132146015496949666601196087654242517185422311506455035842167462078541190698078285535004049669385112367077598199843901211611792222605338988149331119216519696397527477295120274106088266293171556161106770156141014561395640826643742775722571703144525195153998549982845405991080869494513896199391260015745228268485242601988944985992833503950395325474562360096177819141121046453143804285015735706242879583338583034997638582385131157785391509722779564304500626012816937268620613283
# e1 = 7038112844748
# e2 = 4282959134837
# c1 = 22111408385174107047122452095978807498673709429997896604073750876837046388241463820471557783407115244041961838234155779510671617816746772431382535194290634684962496915336624462144951501155794497140409206549024001816566880442566415656929158316183522037187280359297861131630340041792006635692200189211276813841214956798994573609434685215943572033319396078104280532050732455577078319741628202699584742765385481443885297888509975523889770901095407114492869414056910293351862229273130926707571254827338267443402667677882397967618573850448461259968327620285827236841276698960844162927724272570594133203504219806223541623653
# c2 = 13578180388320807904985007779405351222082770590599318356869712446238501365614633526001586969515919500231651291473090184797116141557402625737827413057213233764717087682783039411754926821369731763212236980760782832313430941005846260261878784228053907024506753450152572851710952232826630293101530507361119024128286617019949928103931314878456681338402343835822028706625133252982214806174658888859345948244904674048100040845143761705846316030679130885705967446246259890828294874591285582721878203285873979857493629254912823831856474310339628275471564469283416643606940600951841763306133908095539396505193546252378074614039

# a,b, g = gcdex(e1,e2)
# x = (pow(c1,int(a),n) * pow(c2,int(b),n)) % n

n = 15604066147458655335903884185636746171962486563520885417871496249953829429538766655248025161088253417569188462435671069408305909786581290007549478496495834312370278692374037366060474758932839092251506771880857557785919736821383166507214856682672459700648813568510817182678515196222382270771745529292976541620201881172823939769432343765762806864532563286321473193556642181098684860987492045982759678731942868793228369937526951531237263727577964612996159614096828545898906357955880672734837395555007443728041412370867703034496315052301944751419807647546938005435201579985198045469334539547078292878708645983349639549169
e1 = 23526945546700
e2 = 46104058382895
c1 = 15004348013450935089809875293808385903931974856595650342040379741134350908460931730867336748662907019493236163994425581120720294311119311271259589235615345426457277554989578415562836363519416589973360916994142148559253144844641225139113674728593856688095145463229616919469210776286062241099263376109721895251676951246322975547113550750583800726836675169842338820043580008800442929522467938644560256160907319192335574346585432625433554149159903375031320603103271102485225150739134173237933357883470187729785857136351387188244238562720854828738018629798685293382288121116978519769542802368545089090756834265965506922582
c2 = 5760694765091479519695648996119382096514240163558315944976315776054240054860577752196641342625518392987200644970190180537169320042255673872517462886547290232554960450542358272307071597925213157762335527428445326652432513454043564797543056242332361812012044950208619977579108781887541331382446796964840446227302118987379918333077556787411772092484240507134446152644819406441202008744421176791026332288699974384836469794148217590432501203033219407948688996979083268189219356958515870025903945494674197798455401642753865321796145672464069309786654307769024633126709238553347971313659721679473330217914766296519849083097

a,b, g = gcdex(e1,e2)
m5 = (pow(c1,int(a),n) * pow(c2,int(b),n)) % n

prefic = b'BKSEC{'
m_min = bytes_to_long(prefic.ljust(52, b'\x00'))
k_guess = (m_min ** g) // n

for k in range(k_guess, k_guess + 2):
    val = k * n + m5
    root, is_exact = integer_nthroot(val, g)
    
    if is_exact:
        print(k) 
        print(long_to_bytes(root).decode())
        exit()